@page
@model ReportGenerationApp.Pages.IndexModel
@{
    ViewData["Title"] = "Report Generation Test Home page";
}

<h1>Upload Request (Json) File</h1>
<form method="post" enctype="multipart/form-data" asp-page-handler="Upload" id="uploadForm">
    <input type="file" name="JsonFile" onchange="document.getElementById('uploadForm').submit();" />
</form>

@if (Model.InputJson != null || Model.ResponseJson != null)
{
    <div class="splitter">
        <div class="splitter-left">
            <h2>Input JSON</h2>
            <pre>@Model.InputJson</pre>
        </div>
        <div class="splitter-right">
            <h2>Response JSON</h2>
            <pre>@Model.ResponseJson</pre>
        </div>
    </div>

    <form method="post" asp-page-handler="GenerateDraftReport" onsubmit="showSpinner()">
        <button type="submit">Generate Draft Report</button>
    </form>

    <form method="post" asp-page-handler="PriorReportSummarization">
        <button type="submit">Prior Report Summarization</button>
    </form>
    
    <form method="post" asp-page-handler="Clear">
        <button type="submit">Clear</button>
    </form>
}

<div id="spinner" class="spinner" style="display: none;"></div>

<style>
    .splitter {
        display: flex;
        justify-content: space-between;
    }
    .splitter-left, .splitter-right {
        flex: 1;
        padding: 10px;
        border: 1px solid #ccc;
        margin: 5px;
        text-align: left;
    }
    .splitter-left {
        border-right: none;
    }
    pre {
        white-space: pre-wrap;
        max-width: 120ch; /* 120 characters */
        overflow-wrap: break-word;
    }
    .spinner {
        position: fixed;
        top: 50%;
        left: 50%;
        width: 50px;
        height: 50px;
        border: 5px solid rgba(0, 0, 0, 0.1);
        border-top: 5px solid #000;
        border-radius: 50%;
        animation: spin 1s linear infinite;
    }
    @@keyframes spin {
        0% { transform: translate(-50%, -50%) rotate(0deg); }
        100% { transform: translate(-50%, -50%) rotate(360deg); }
    }
</style>

<script>
    function showSpinner() {
        document.getElementById('spinner').style.display = 'block';
    }
</script>